define("jquery underscore app/utils/utils app/utils/tracking text!app/template/panier.html app/view/livraisonView".split(" "),function(a,g,l,m,h,k){return function(){this.init=function(){this.el=a("#panier-popup");(this.listArticle=JSON.parse(sessionStorage.getItem("aeferrets.panier")))?a(".panier").show("slow"):this.listArticle=[];this.render()};this.render=function(){g.templateSettings.variable="data";var a=g.template(h);this.el.html(a({}));this.livraison=new k;this.makeEvents()};this.makeEvents=
function(){var b=this;a("#panier").click(function(){b.showArticles()});a("#panier-popup .mask, #panier-popup .close").click(function(){a("#panier-popup").hide()});a("#panier-popup .next").click(function(){b.livraison.render(b.listArticle)})};this.addArticle=function(b,c){this.listArticle.push({name:b,price:c});sessionStorage.setItem("aeferrets.panier",JSON.stringify(this.listArticle));a(".panier").show("slow")};this.removeArticle=function(b){this.listArticle.slice(b,1);sessionStorage.setItem("aeferrets.panier",
JSON.stringify(this.listArticle));this.refreshArticles();0==this.listArticle.length&&(sessionStorage.removeItem("aeferrets.panier"),a(".panier").hide("slow"))};this.showArticles=function(){this.refreshArticles();a("#panier-popup").show()};this.refreshArticles=function(){a(".panier-articles").empty();var b=0,c=this,d;for(d in this.listArticle){var e=this.listArticle[d],f=a("\x3cli/\x3e");f.attr("index",d);f.text(e.name+" : "+e.price+" euros");a(".panier-articles").append(f);b=(1E5*b+1E5*parseFloat(e.price))/
1E5}a(".panier-articles li").click(function(b){b=a(this).attr("index");c.listArticle.splice(b,1);c.refreshArticles()});0<b?a(".panier-popup-content .total").text("Total : "+b.toFixed(2)+" euros + frais de livraison"):(a("#panier-popup").hide(),a(".panier").hide("slow"))};this.init()}});